<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>used community</title>
    <link href="design/design.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    
    <script src="script/script.js"></script>
    
    <script
      type="text/javascript"
      src="script/vis-network.min.js"
    ></script>

    <script src="script/data.js"></script>
   
   <style type="text/css">
        #mynetwork {
          margin-left: 5%;
          margin-right: 5%;
          width: 1600px;
          height: 1200px;
        }
    </style>

</head>

<body>
  <div class="container">
    <div class="navbar">
      <img src="pictures/used-logo-white-top.png" alt="logo">
      <nav>
        <ul>
          <li><a href="index.html">used</a></li>
          <li><a href="data.html">requirements</a></li>
          <li><a href="https://github.com/usedcommunity/used/wiki" target="_blank">wiki</a></li>
          <li><a href="https://mastodon.social/@usedcommunity" target="_blank">blog</a></li>
        </ul>
      </nav>
    </div>

    <div class="content">     
                  
      <div class="graph-container">
        <div id="mynetwork">
          <script type="text/javascript">
            var network;
            var allNodes;
            var highlightActive = false;
            var nodesDataset = new vis.DataSet(nodes);
            var edgesDataset = new vis.DataSet(edges);
      
            function redrawAll() {
              var container = document.getElementById("mynetwork");
              var options = {
                nodes: {
                  shape: "dot",
                  scaling: {
                    min: 10,
                    max: 30,
                    label: {
                      min: 8,
                      max: 30,
                      drawThreshold: 12,
                      maxVisible: 20,
                      font: {
                        multi: true,
                        html: true,
                      },
                    },
                  },
                  font: {
                    size: 12,
                    color: '#ffffff', // Weiß
                    face: "Tahoma",
                  },
                },
                edges: {
                  width: 0.15,
                  color: { inherit: "from" },
                  smooth: {
                    type: "continuous",
                  },
                },
                physics: false,
                interaction: {
                  tooltipDelay: 200,
                  hideEdgesOnDrag: true,
                  hideEdgesOnZoom: true,
                },
              };
              var data = { nodes: nodesDataset, edges: edgesDataset };
              network = new vis.Network(container, data, options);
              allNodes = nodesDataset.get({ returnType: "Object" });
              network.on("click", neighbourhoodHighlight);
            }
      
            function neighbourhoodHighlight(params) {
              // if something is selected:
              if (params.nodes.length > 0) {
                highlightActive = true;
                var i, j;
                var selectedNode = params.nodes[0];
                var degrees = 2;
      
                // mark all nodes as hard to read.
                for (var nodeId in allNodes) {
                  allNodes[nodeId].color = "rgba(255,255,255,0.5)";
                  if (allNodes[nodeId].hiddenLabel === undefined) {
                    allNodes[nodeId].hiddenLabel = allNodes[nodeId].label;
                    allNodes[nodeId].label = undefined;
                  }
                }
                var connectedNodes = network.getConnectedNodes(selectedNode);
                var allConnectedNodes = [];
      
                // get the second degree nodes
                for (i = 1; i < degrees; i++) {
                  for (j = 0; j < connectedNodes.length; j++) {
                    allConnectedNodes = allConnectedNodes.concat(
                      network.getConnectedNodes(connectedNodes[j])
                    );
                  }
                }
      
                // all second degree nodes get a different color and their label back
                for (i = 0; i < allConnectedNodes.length; i++) {
                  allNodes[allConnectedNodes[i]].color = "rgba(255,255,255,0.75)";
                  if (allNodes[allConnectedNodes[i]].hiddenLabel !== undefined) {
                    allNodes[allConnectedNodes[i]].label =
                      allNodes[allConnectedNodes[i]].hiddenLabel;
                    allNodes[allConnectedNodes[i]].hiddenLabel = undefined;
                  }
                }
      
                // all first degree nodes get their own color and their label back
                for (i = 0; i < connectedNodes.length; i++) {
                  allNodes[connectedNodes[i]].color = "rgba(255,255,255,0.75)";
                  if (allNodes[connectedNodes[i]].hiddenLabel !== undefined) {
                    allNodes[connectedNodes[i]].label =
                      allNodes[connectedNodes[i]].hiddenLabel;
                    allNodes[connectedNodes[i]].hiddenLabel = undefined;
                  }
                }
      
                // the main node gets its own color and its label back.
                allNodes[selectedNode].color = undefined;
                
                if (allNodes[selectedNode].hiddenLabel !== undefined) {
                  allNodes[selectedNode].label = allNodes[selectedNode].hiddenLabel;
                  allNodes[selectedNode].hiddenLabel = undefined;
                }

              } else if (highlightActive === true) {
                
                // reset all nodes
                for (var nodeId in allNodes) {
                  allNodes[nodeId].color = undefined;
                  if (allNodes[nodeId].hiddenLabel !== undefined) {
                    allNodes[nodeId].label = allNodes[nodeId].hiddenLabel;
                    allNodes[nodeId].hiddenLabel = undefined;
                  }
                }
                highlightActive = false;
              }
      
              // transform the object into an array
              var updateArray = [];
              
              for (nodeId in allNodes) {
                if (allNodes.hasOwnProperty(nodeId)) {
                  updateArray.push(allNodes[nodeId]);
                }
              }
              nodesDataset.update(updateArray);
            }
      
            redrawAll();

          </script>
        </div>   
      </div>
    
    </div>
    
    <div class="footer"> 
      <div class="link-container"> 
        <a class="share-button" id="shareButton1" href="https://used.community" target="_blank"><img src="pictures/used-logo-rgb-buttom.png" alt="Bild 1"></a>
        <a class="share-button" id="shareButton3" href="imp.html" target="_blank">Imprint</a>
        <a class="share-button" id="shareButton4" href="privacy.html" target="_blank">privacy</a>
        <a class="share-button" onclick="openEmail()">contact</a>        
      </div>
        
      <div class="imp-container">
        <p class="impress">© used.community</p> 
      </div>
    </div>
  </div>
</body>
</html>